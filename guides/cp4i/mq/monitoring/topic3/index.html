<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The Cloud Pak Production Deployment Guides document and demonstrate how to run cloud-native solutions leveraging IBM Cloud Pak capabilities in a Red Hat OpenShift environment"><meta name=author content="Cloud Pak Production Deployment Guides development team"><link rel=icon href=../../../../../images/cloudnativetoolkit.png><meta name=generator content="mkdocs-1.3.0, mkdocs-material-8.2.9"><title>Metrics application - Cloud Pak Production Deployment Guides</title><link rel=stylesheet href=../../../../../assets/stylesheets/main.120efc48.min.css><link rel=stylesheet href=../../../../../assets/stylesheets/palette.9647289d.min.css><meta name=theme-color content=#000000><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,300i,400,400i,700,700i%7CIBM+Plex+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"IBM Plex Sans";--md-code-font:"IBM Plex Mono"}</style><link rel=stylesheet href=../../../../../css/extra.css><link rel=stylesheet href=../../../../../css/toolkit-code.css><script>__md_scope=new URL("../../../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-Q0FLL49YN3"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-Q0FLL49YN3",{page_path:e.pathname})})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-Q0FLL49YN3"></script><!-- Determine title --><!-- The image needs to have an absolute URL --><!-- Open graph meta tags --><meta property=og:type content=website><meta property=og:title content="Cloud Pak Production Deployment Guides - Metrics application"><meta property=og:description content="The Cloud Pak Production Deployment Guides document and demonstrate how to run cloud-native solutions leveraging IBM Cloud Pak capabilities in a Red Hat OpenShift environment"><meta property=og:url content=None><meta property=og:image content=assets/images/banner.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1080><meta property=og:image:height content=568></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=black data-md-color-accent> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#metrics-application class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../../.. title="Cloud Pak Production Deployment Guides" class="md-header__button md-logo" aria-label="Cloud Pak Production Deployment Guides" data-md-component=logo> <img src=../../../../../images/cloudnativetoolkit.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Cloud Pak Production Deployment Guides </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Metrics application </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.ibm.com/cloudpakbringup/production-deployment-guides title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../../../overview/overview/ class=md-tabs__link> Production Considerations </a> </li> <li class=md-tabs__item> <a href=../../../../../quickstart/overview/ class=md-tabs__link> Quick Start Demos </a> </li> <li class=md-tabs__item> <a href=../../../../guides-overview/ class="md-tabs__link md-tabs__link--active"> Tutorials </a> </li> <li class=md-tabs__item> <a href=../../../../../infrastructure/ad/ class=md-tabs__link> References </a> </li> <li class=md-tabs__item> <a href=../../../../../overview/whats-new/ class=md-tabs__link> About </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <!-- Determine class according to configuration --> <!-- Main navigation --> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <!-- Site title --> <!--
  <label class="md-nav__title" for="__drawer">
    <a
      href="../../../../.."
      title="Cloud Pak Production Deployment Guides"
      class="md-nav__button md-logo"
      aria-label="Cloud Pak Production Deployment Guides"
      data-md-component="logo"
    >
      
  <img src="../../../../../images/cloudnativetoolkit.png" alt="logo">

    </a>
    Cloud Pak Production Deployment Guides
  </label>
--> <!-- Repository information --> <div class=md-nav__source> <a href=https://github.ibm.com/cloudpakbringup/production-deployment-guides title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> </div> </a> </div> <!-- Render item list --> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Production Considerations <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Production Considerations" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Production Considerations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../overview/overview/ class=md-nav__link> Objective </a> </li> <li class=md-nav__item> <a href=../../../../../gitops/personas/ class=md-nav__link> Personas </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3> DevOps Automation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="DevOps Automation" data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> DevOps Automation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../automation/why-automate/ class=md-nav__link> Why Automate? </a> </li> <li class=md-nav__item> <a href=../../../../../gitops/structure/ class=md-nav__link> GitOps Structure </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> Golden Topologies <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Golden Topologies" data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Golden Topologies </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../infrastructure/golden-topology/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../../../infrastructure/golden-topology-azure/ class=md-nav__link> Azure Unmanaged </a> </li> <li class=md-nav__item> <a href=../../../../../infrastructure/golden-topology-aro/ class=md-nav__link> Azure Managed (ARO) </a> </li> <li class=md-nav__item> <a href=../../../../../infrastructure/golden-topology-aws/ class=md-nav__link> AWS Unmanaged </a> </li> <li class=md-nav__item> <a href=../../../../../infrastructure/golden-topology-rosa/ class=md-nav__link> AWS Managed (ROSA) </a> </li> <li class=md-nav__item> <a href=../../../../../infrastructure/golden-topology-roks/ class=md-nav__link> IBM Cloud Managed (ROKS) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_5 type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5> Cloud Pak for Integration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Cloud Pak for Integration" data-md-level=2> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Cloud Pak for Integration </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_5_1 type=checkbox id=__nav_2_5_1> <label class=md-nav__link for=__nav_2_5_1> IBM App Connect Enterprise <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="IBM App Connect Enterprise" data-md-level=3> <label class=md-nav__title for=__nav_2_5_1> <span class="md-nav__icon md-icon"></span> IBM App Connect Enterprise </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ace/overview/architecture/ class=md-nav__link> Architecture </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_5_2 type=checkbox id=__nav_2_5_2> <label class=md-nav__link for=__nav_2_5_2> IBM Message Queue <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="IBM Message Queue" data-md-level=3> <label class=md-nav__title for=__nav_2_5_2> <span class="md-nav__icon md-icon"></span> IBM Message Queue </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../overview/architecture/ class=md-nav__link> Architecture </a> </li> <li class=md-nav__item> <a href=../../security/information/overview/ class=md-nav__link> Security </a> </li> <li class=md-nav__item> <a href=../../cloud-native/promote-environments/ class=md-nav__link> Promoting across environments </a> </li> <li class=md-nav__item> <a href=../../performance/performance/ class=md-nav__link> Performance </a> </li> <li class=md-nav__item> <a href=../../high-availability/overview/ class=md-nav__link> High Availability </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_5_3 type=checkbox id=__nav_2_5_3> <label class=md-nav__link for=__nav_2_5_3> IBM API Connect <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="IBM API Connect" data-md-level=3> <label class=md-nav__title for=__nav_2_5_3> <span class="md-nav__icon md-icon"></span> IBM API Connect </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_5_3_1 type=checkbox id=__nav_2_5_3_1> <label class=md-nav__link for=__nav_2_5_3_1> Architecture <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Architecture data-md-level=4> <label class=md-nav__title for=__nav_2_5_3_1> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../apic/architecture/ibm-cloud/ class=md-nav__link> IBM Cloud </a> </li> <li class=md-nav__item> <a href=../../../apic/architecture/multi-cloud/ class=md-nav__link> Multi-cloud </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../apic/security/overview/ class=md-nav__link> Security </a> </li> <li class=md-nav__item> <a href=../../../apic/high-availability/overview/ class=md-nav__link> High Availability </a> </li> <li class=md-nav__item> <a href=../../../apic/disaster-recovery/overview/ class=md-nav__link> Disaster Recovery </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_5_4 type=checkbox id=__nav_2_5_4> <label class=md-nav__link for=__nav_2_5_4> IBM Sterling File Gateway <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="IBM Sterling File Gateway" data-md-level=3> <label class=md-nav__title for=__nav_2_5_4> <span class="md-nav__icon md-icon"></span> IBM Sterling File Gateway </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../sterling/overview/architecture.md class=md-nav__link> Architecture </a> </li> <li class=md-nav__item> <a href=../../../sterling/monitoring.md class=md-nav__link> Monitoring </a> </li> <li class=md-nav__item> <a href=../../../sterling/high-availability/overview.md class=md-nav__link> High Availability </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_6 type=checkbox id=__nav_2_6> <label class=md-nav__link for=__nav_2_6> Cloud Pak for Business Automation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Cloud Pak for Business Automation" data-md-level=2> <label class=md-nav__title for=__nav_2_6> <span class="md-nav__icon md-icon"></span> Cloud Pak for Business Automation </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_6_1 type=checkbox id=__nav_2_6_1> <label class=md-nav__link for=__nav_2_6_1> IBM Automation Decision Services <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="IBM Automation Decision Services" data-md-level=3> <label class=md-nav__title for=__nav_2_6_1> <span class="md-nav__icon md-icon"></span> IBM Automation Decision Services </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../cp4ba/ads/architecture/ads/ class=md-nav__link> Architecture </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_6_2 type=checkbox id=__nav_2_6_2> <label class=md-nav__link for=__nav_2_6_2> IBM Process Mining <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="IBM Process Mining" data-md-level=3> <label class=md-nav__title for=__nav_2_6_2> <span class="md-nav__icon md-icon"></span> IBM Process Mining </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../cp4ba/process-mining/architecture/ibm-cloud/ class=md-nav__link> Architecture </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_7 type=checkbox id=__nav_2_7> <label class=md-nav__link for=__nav_2_7> Cloud Pak for Data <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Cloud Pak for Data" data-md-level=2> <label class=md-nav__title for=__nav_2_7> <span class="md-nav__icon md-icon"></span> Cloud Pak for Data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../cp4d-hadr/cpdbase/overview/architecture/ class=md-nav__link> Architecture </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Quick Start Demos <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Quick Start Demos" data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Quick Start Demos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../quickstart/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../../../quickstart/quickstart-cntk/ class=md-nav__link> Cloud Native Toolkit </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3> Cloud Pak for Integration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Cloud Pak for Integration" data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Cloud Pak for Integration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../quickstart/quickstart-ace/ class=md-nav__link> IBM App Connect Enterprise </a> </li> <li class=md-nav__item> <a href=../../../../../quickstart/quickstart-mq/ class=md-nav__link> IBM Message Queue </a> </li> <li class=md-nav__item> <a href=../../../../../quickstart/quickstart-apic/ class=md-nav__link> IBM API Connect </a> </li> <li class=md-nav__item> <a href=../../../../../quickstart/quickstart-es/ class=md-nav__link> IBM Event Streams </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4> Cloud Pak for Security <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Cloud Pak for Security" data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Cloud Pak for Security </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../quickstart/quickstart-cp4s/ class=md-nav__link> Cloud Pak for Security </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_5 type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5> Cloud Pak for Business Automation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Cloud Pak for Business Automation" data-md-level=2> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Cloud Pak for Business Automation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../quickstart/quickstart-process-mining/ class=md-nav__link> IBM Process Mining </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_6 type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6> Cloud Pak for Data <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Cloud Pak for Data" data-md-level=2> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Cloud Pak for Data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../quickstart/quickstart-cp4d/ class=md-nav__link> Cloud Pak for Data </a> </li> <li class=md-nav__item> <a href=../../../../../quickstart/quickstart-cp4d-ws/ class=md-nav__link> IBM Watson Studio </a> </li> <li class=md-nav__item> <a href=../../../../../quickstart/quickstart-cp4d-wkc/ class=md-nav__link> IBM Watson Knowledge Catalog </a> </li> <li class=md-nav__item> <a href=../../../../../quickstart/quickstart-cp4d-ds/ class=md-nav__link> IBM DataStage </a> </li> <li class=md-nav__item> <a href=../../../../../quickstart/quickstart-cp4d-aespark/ class=md-nav__link> IBM Analytics Engine Powered by Apache Spark </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_7 type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7> Observability <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Observability data-md-level=2> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Observability </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../quickstart/quickstart-instana-agent/ class=md-nav__link> Instana Agent </a> </li> <li class=md-nav__item> <a href=../../../../../quickstart/quickstart-instana-grafana/ class=md-nav__link> Instana & Grafana </a> </li> <li class=md-nav__item> <a href=../../../../../quickstart/quickstart-instana-server/ class=md-nav__link> Instana Server </a> </li> <li class=md-nav__item> <a href=../../../../../quickstart/quickstart-instana-mq/ class=md-nav__link> Instana & MQ </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_8 type=checkbox id=__nav_3_8> <label class=md-nav__link for=__nav_3_8> Sterling B2Bi <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Sterling B2Bi" data-md-level=2> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> Sterling B2Bi </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../quickstart/quickstart-sterling-b2bi/ class=md-nav__link> Sterling File Gateway </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4> Tutorials <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tutorials data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../guides-overview/ class=md-nav__link> Overview </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2> Infrastructure <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Infrastructure data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Infrastructure </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../infrastructure/infra-overview/ class=md-nav__link> Overview </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2_2 type=checkbox id=__nav_4_2_2> <label class=md-nav__link for=__nav_4_2_2> Managed Clusters <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Managed Clusters" data-md-level=3> <label class=md-nav__title for=__nav_4_2_2> <span class="md-nav__icon md-icon"></span> Managed Clusters </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../infrastructure/roks/ class=md-nav__link> IBM ROKS </a> </li> <li class=md-nav__item> <a href=../../../../../infrastructure/rosa/ class=md-nav__link> Amazon ROSA </a> </li> <li class=md-nav__item> <a href=../../../../../infrastructure/aro/ class=md-nav__link> Microsoft ARO </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2_3 type=checkbox id=__nav_4_2_3> <label class=md-nav__link for=__nav_4_2_3> Unmanaged Clusters <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Unmanaged Clusters" data-md-level=3> <label class=md-nav__title for=__nav_4_2_3> <span class="md-nav__icon md-icon"></span> Unmanaged Clusters </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../infrastructure/aws/ class=md-nav__link> Amazon AWS </a> </li> <li class=md-nav__item> <a href=../../../../../infrastructure/azure/ class=md-nav__link> Microsoft Azure </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../../infrastructure/restricted-networks/ class=md-nav__link> Restricted Networks </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3 type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3> IBM Sterling File Gatway <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="IBM Sterling File Gatway" data-md-level=2> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> IBM Sterling File Gatway </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../sterling/using/this-guide.md class=md-nav__link> The Sterling tutorial </a> </li> <li class=md-nav__item> <a href=../../../sterling/overview/architecture.md class=md-nav__link> Target architecture </a> </li> <li class=md-nav__item> <a href=../../../sterling/cluster-create/ibm-setup.md class=md-nav__link> Create the cluster </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4 type=checkbox id=__nav_4_3_4> <label class=md-nav__link for=__nav_4_3_4> Configure the cluster <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Configure the cluster" data-md-level=3> <label class=md-nav__title for=__nav_4_3_4> <span class="md-nav__icon md-icon"></span> Configure the cluster </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../sterling/cluster-config/gitops-tekton-argocd.md class=md-nav__link> Set up GitOps </a> </li> <li class=md-nav__item> <a href=../../../sterling/cluster-config/gitops-config.md class=md-nav__link> Add infrastructure </a> </li> <li class=md-nav__item> <a href=../../../sterling/cluster-config/services.md class=md-nav__link> Add services </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_5 type=checkbox id=__nav_4_3_5> <label class=md-nav__link for=__nav_4_3_5> Architecture Decisions <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Architecture Decisions" data-md-level=3> <label class=md-nav__title for=__nav_4_3_5> <span class="md-nav__icon md-icon"></span> Architecture Decisions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ad/ class=md-nav__link> Decision Index </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4 type=checkbox id=__nav_4_4 checked> <label class=md-nav__link for=__nav_4_4> Cloud Pak for Integration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Cloud Pak for Integration" data-md-level=2> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Cloud Pak for Integration </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_1 type=checkbox id=__nav_4_4_1> <label class=md-nav__link for=__nav_4_4_1> IBM App Connect Enterprise <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="IBM App Connect Enterprise" data-md-level=3> <label class=md-nav__title for=__nav_4_4_1> <span class="md-nav__icon md-icon"></span> IBM App Connect Enterprise </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ace/overview/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../ace/overview/architecture/ class=md-nav__link> Architecture </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_1_3 type=checkbox id=__nav_4_4_1_3> <label class=md-nav__link for=__nav_4_4_1_3> Create the cluster <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Create the cluster" data-md-level=4> <label class=md-nav__title for=__nav_4_4_1_3> <span class="md-nav__icon md-icon"></span> Create the cluster </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ace/cluster-create/ibm-setup/ class=md-nav__link> IBM Cloud </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_1_4 type=checkbox id=__nav_4_4_1_4> <label class=md-nav__link for=__nav_4_4_1_4> Configure the Cluster <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Configure the Cluster" data-md-level=4> <label class=md-nav__title for=__nav_4_4_1_4> <span class="md-nav__icon md-icon"></span> Configure the Cluster </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ace/cluster-config/gitops-tekton-argocd/ class=md-nav__link> GitOps, Tekton & ArgoCD </a> </li> <li class=md-nav__item> <a href=../../../ace/cluster-config/gitops-config/ class=md-nav__link> Getting started with GitOps </a> </li> <li class=md-nav__item> <a href=../../../ace/cluster-config/services/ class=md-nav__link> Deploying Services </a> </li> <li class=md-nav__item> <a href=../../../ace/cluster-config/applications/ class=md-nav__link> Application components </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../ace/cloud-native-example/example/ class=md-nav__link> Cloud Native Example </a> </li> <li class=md-nav__item> <a href=../../../ace/deploy-backend-service/deploy-backend-service/ class=md-nav__link> Deploy Backend Service </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_1_7 type=checkbox id=__nav_4_4_1_7> <label class=md-nav__link for=__nav_4_4_1_7> Build Integration Server <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Build Integration Server" data-md-level=4> <label class=md-nav__title for=__nav_4_4_1_7> <span class="md-nav__icon md-icon"></span> Build Integration Server </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ace/build-integration-server/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../ace/build-integration-server/build-configurations/ class=md-nav__link> Build Configuration </a> </li> <li class=md-nav__item> <a href=../../../ace/build-integration-server/build-integration-server/ class=md-nav__link> Build Integration Server </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../ace/environment-promotion/promoting-environments/ class=md-nav__link> Environment Promotion </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_2 type=checkbox id=__nav_4_4_2 checked> <label class=md-nav__link for=__nav_4_4_2> IBM MQ <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="IBM MQ" data-md-level=3> <label class=md-nav__title for=__nav_4_4_2> <span class="md-nav__icon md-icon"></span> IBM MQ </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../using/this-guide/ class=md-nav__link> The MQ tutorial </a> </li> <li class=md-nav__item> <a href=../../overview/architecture/ class=md-nav__link> Target architecture </a> </li> <li class=md-nav__item> <a href=../../cluster-create/ibm-setup/ class=md-nav__link> Create the cluster </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_2_4 type=checkbox id=__nav_4_4_2_4> <label class=md-nav__link for=__nav_4_4_2_4> Configure the cluster <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Configure the cluster" data-md-level=4> <label class=md-nav__title for=__nav_4_4_2_4> <span class="md-nav__icon md-icon"></span> Configure the cluster </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cluster-config/gitops-tekton-argocd/ class=md-nav__link> Set up GitOps </a> </li> <li class=md-nav__item> <a href=../../cluster-config/gitops-config/ class=md-nav__link> Add infrastructure </a> </li> <li class=md-nav__item> <a href=../../cluster-config/services/ class=md-nav__link> Add services </a> </li> <li class=md-nav__item> <a href=../../cluster-config/applications/ class=md-nav__link> Application components </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_2_5 type=checkbox id=__nav_4_4_2_5> <label class=md-nav__link for=__nav_4_4_2_5> Build Queue Manager <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Build Queue Manager" data-md-level=4> <label class=md-nav__title for=__nav_4_4_2_5> <span class="md-nav__icon md-icon"></span> Build Queue Manager </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../qmgr-pipeline/topic1/ class=md-nav__link> Configuring the pipeline </a> </li> <li class=md-nav__item> <a href=../../qmgr-pipeline/topic2/ class=md-nav__link> Running the pipeline </a> </li> <li class=md-nav__item> <a href=../../qmgr-pipeline/topic3/ class=md-nav__link> Deploying and using </a> </li> <li class=md-nav__item> <a href=../../qmgr-pipeline/topic4/ class=md-nav__link> Continuous updates </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_2_6 type=checkbox id=__nav_4_4_2_6> <label class=md-nav__link for=__nav_4_4_2_6> Build MQ application <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Build MQ application" data-md-level=4> <label class=md-nav__title for=__nav_4_4_2_6> <span class="md-nav__icon md-icon"></span> Build MQ application </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../app-pipeline/topic1/ class=md-nav__link> Sample application </a> </li> <li class=md-nav__item> <a href=../../app-pipeline/topic2/ class=md-nav__link> Configuring the pipeline </a> </li> <li class=md-nav__item> <a href=../../app-pipeline/topic3/ class=md-nav__link> Managing an application change </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_2_7 type=checkbox id=__nav_4_4_2_7> <label class=md-nav__link for=__nav_4_4_2_7> Environment Promotion <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Environment Promotion" data-md-level=4> <label class=md-nav__title for=__nav_4_4_2_7> <span class="md-nav__icon md-icon"></span> Environment Promotion </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cloud-native/promoting-environments-dev-stage/ class=md-nav__link> Promote from dev to staging </a> </li> <li class=md-nav__item> <a href=../../cloud-native/promoting-environments-stage-prod/ class=md-nav__link> Promote from staging to prod </a> </li> <li class=md-nav__item> <a href=../../cloud-native/automate-promotion/ class=md-nav__link> Automate promotion </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_2_8 type=checkbox id=__nav_4_4_2_8 checked> <label class=md-nav__link for=__nav_4_4_2_8> Monitor Queue Manager <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Monitor Queue Manager" data-md-level=4> <label class=md-nav__title for=__nav_4_4_2_8> <span class="md-nav__icon md-icon"></span> Monitor Queue Manager </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../topic1/ class=md-nav__link> Technology stack </a> </li> <li class=md-nav__item> <a href=../topic2/ class=md-nav__link> MQ scenario </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Metrics application <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Metrics application </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=#introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=#creating-metrics-app-repo class=md-nav__link> Creating metrics app repo </a> </li> <li class=md-nav__item> <a href=#prepare-queue-manager class=md-nav__link> Prepare Queue Manager </a> </li> <li class=md-nav__item> <a href=#enable-ci-resources class=md-nav__link> Enable CI resources </a> </li> <li class=md-nav__item> <a href=#build-and-deploy-app class=md-nav__link> Build and deploy app </a> </li> <li class=md-nav__item> <a href=#verify-app-deployment class=md-nav__link> Verify app deployment </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../topic4/ class=md-nav__link> Customising dashboard </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_2_9 type=checkbox id=__nav_4_4_2_9> <label class=md-nav__link for=__nav_4_4_2_9> Expose MQ App APIs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Expose MQ App APIs" data-md-level=4> <label class=md-nav__title for=__nav_4_4_2_9> <span class="md-nav__icon md-icon"></span> Expose MQ App APIs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../apic/deploy-apic/ class=md-nav__link> Deploy API Connect </a> </li> <li class=md-nav__item> <a href=../../apic/configure-apic/ class=md-nav__link> Configure API Connect </a> </li> <li class=md-nav__item> <a href=../../apic/publish-apis/ class=md-nav__link> Publish APIs </a> </li> <li class=md-nav__item> <a href=../../apic/consume-apis/ class=md-nav__link> Consume APIs </a> </li> <li class=md-nav__item> <a href=../../apic/monitor-apis/ class=md-nav__link> Monitor APIs </a> </li> <li class=md-nav__item> <a href=../../apic/promote-apis/ class=md-nav__link> Promote APIs </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_2_10 type=checkbox id=__nav_4_4_2_10> <label class=md-nav__link for=__nav_4_4_2_10> Architecture Decisions <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Architecture Decisions" data-md-level=4> <label class=md-nav__title for=__nav_4_4_2_10> <span class="md-nav__icon md-icon"></span> Architecture Decisions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ad/ class=md-nav__link> Decision Index </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_3 type=checkbox id=__nav_4_4_3> <label class=md-nav__link for=__nav_4_4_3> IBM API Connect <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="IBM API Connect" data-md-level=3> <label class=md-nav__title for=__nav_4_4_3> <span class="md-nav__icon md-icon"></span> IBM API Connect </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../apic/overview/overview/ class=md-nav__link> Overview </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_3_2 type=checkbox id=__nav_4_4_3_2> <label class=md-nav__link for=__nav_4_4_3_2> Create the cluster <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Create the cluster" data-md-level=4> <label class=md-nav__title for=__nav_4_4_3_2> <span class="md-nav__icon md-icon"></span> Create the cluster </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../apic/cluster-create/ibm-cloud/ class=md-nav__link> IBM Cloud </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_3_3 type=checkbox id=__nav_4_4_3_3> <label class=md-nav__link for=__nav_4_4_3_3> Configure the cluster <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Configure the cluster" data-md-level=4> <label class=md-nav__title for=__nav_4_4_3_3> <span class="md-nav__icon md-icon"></span> Configure the cluster </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../apic/cluster-config/gitops-tekton-argocd/ class=md-nav__link> GitOps, Tekton & ArgoCD </a> </li> <li class=md-nav__item> <a href=../../../apic/cluster-config/gitops-config/ class=md-nav__link> Getting started with GitOps </a> </li> <li class=md-nav__item> <a href=../../../apic/cluster-config/applications/ class=md-nav__link> Application components </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_3_4 type=checkbox id=__nav_4_4_3_4> <label class=md-nav__link for=__nav_4_4_3_4> Deploy APIC <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Deploy APIC" data-md-level=4> <label class=md-nav__title for=__nav_4_4_3_4> <span class="md-nav__icon md-icon"></span> Deploy APIC </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../apic/deployment/ibm-cloud/ class=md-nav__link> IBM Cloud </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_3_5 type=checkbox id=__nav_4_4_3_5> <label class=md-nav__link for=__nav_4_4_3_5> Configure APIC <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Configure APIC" data-md-level=4> <label class=md-nav__title for=__nav_4_4_3_5> <span class="md-nav__icon md-icon"></span> Configure APIC </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../apic/configuration/ibm-cloud/ class=md-nav__link> IBM Cloud </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_3_6 type=checkbox id=__nav_4_4_3_6> <label class=md-nav__link for=__nav_4_4_3_6> Publish APIs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Publish APIs" data-md-level=4> <label class=md-nav__title for=__nav_4_4_3_6> <span class="md-nav__icon md-icon"></span> Publish APIs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../apic/publish/ibm-cloud/ class=md-nav__link> IBM Cloud </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_4 type=checkbox id=__nav_4_4_4> <label class=md-nav__link for=__nav_4_4_4> IBM API Connect Multi-Cluster <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="IBM API Connect Multi-Cluster" data-md-level=3> <label class=md-nav__title for=__nav_4_4_4> <span class="md-nav__icon md-icon"></span> IBM API Connect Multi-Cluster </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../apic/multi-cluster/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../apic/multi-cluster/create-clusters/ class=md-nav__link> Create the cluster </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_4_3 type=checkbox id=__nav_4_4_4_3> <label class=md-nav__link for=__nav_4_4_4_3> Configure the clusters <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Configure the clusters" data-md-level=4> <label class=md-nav__title for=__nav_4_4_4_3> <span class="md-nav__icon md-icon"></span> Configure the clusters </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../apic/multi-cluster/configure-clusters-gitops/ class=md-nav__link> GitOps repos & ArgoCD </a> </li> <li class=md-nav__item> <a href=../../../apic/multi-cluster/configure-clusters-gitops-config/ class=md-nav__link> Configure GitOps repos </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../apic/multi-cluster/deploy/ class=md-nav__link> Deploy APIC </a> </li> <li class=md-nav__item> <a href=../../../apic/multi-cluster/config-pipeline/ class=md-nav__link> Configure APIC </a> </li> <li class=md-nav__item> <a href=../../../apic/multi-cluster/publish-pipeline/ class=md-nav__link> Publish APIs </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_5 type=checkbox id=__nav_4_4_5> <label class=md-nav__link for=__nav_4_4_5> Event-Driven Architecture <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Event-Driven Architecture" data-md-level=3> <label class=md-nav__title for=__nav_4_4_5> <span class="md-nav__icon md-icon"></span> Event-Driven Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../eda/link/ class=md-nav__link> EDA GitOps Solution </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_5 type=checkbox id=__nav_4_5> <label class=md-nav__link for=__nav_4_5> Cloud Pak for Security <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Cloud Pak for Security" data-md-level=2> <label class=md-nav__title for=__nav_4_5> <span class="md-nav__icon md-icon"></span> Cloud Pak for Security </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../cp4s/cp4s-tree/using/this-guide/ class=md-nav__link> The CP4S tutorial </a> </li> <li class=md-nav__item> <a href=../../../../cp4s/cp4s-tree/overview/architecture/ class=md-nav__link> CP4S architecture </a> </li> <li class=md-nav__item> <a href=../../../../cp4s/cp4s-tree/cluster-create/ibm-setup/ class=md-nav__link> Create the cluster </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_5_4 type=checkbox id=__nav_4_5_4> <label class=md-nav__link for=__nav_4_5_4> Configure the cluster <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Configure the cluster" data-md-level=3> <label class=md-nav__title for=__nav_4_5_4> <span class="md-nav__icon md-icon"></span> Configure the cluster </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../cp4s/cp4s-tree/cluster-config/gitops-tekton-argocd/ class=md-nav__link> Set up GitOps </a> </li> <li class=md-nav__item> <a href=../../../../cp4s/cp4s-tree/cluster-config/gitops-config/ class=md-nav__link> Add infrastructure </a> </li> <li class=md-nav__item> <a href=../../../../cp4s/cp4s-tree/cluster-config/services/ class=md-nav__link> Add services </a> </li> <li class=md-nav__item> <a href=../../../../cp4s/cp4s-tree/cluster-config/backup-recovery-upgrade/ class=md-nav__link> Managing Lifecycle for CP4S </a> </li> <li class=md-nav__item> <a href=../../../../cp4s/cp4s-tree/cluster-config/connect-datasources/ class=md-nav__link> Connecting DataSources for CP4S </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_6 type=checkbox id=__nav_4_6> <label class=md-nav__link for=__nav_4_6> Cloud Pak for Data <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Cloud Pak for Data" data-md-level=2> <label class=md-nav__title for=__nav_4_6> <span class="md-nav__icon md-icon"></span> Cloud Pak for Data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../cp4d/platform/overview/ class=md-nav__link> Overview </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_6_2 type=checkbox id=__nav_4_6_2> <label class=md-nav__link for=__nav_4_6_2> Create the cluster <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Create the cluster" data-md-level=3> <label class=md-nav__title for=__nav_4_6_2> <span class="md-nav__icon md-icon"></span> Create the cluster </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../cp4d/cluster-create/ibm-setup/ class=md-nav__link> IBM Cloud </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_6_3 type=checkbox id=__nav_4_6_3> <label class=md-nav__link for=__nav_4_6_3> Configure the Cluster <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Configure the Cluster" data-md-level=3> <label class=md-nav__title for=__nav_4_6_3> <span class="md-nav__icon md-icon"></span> Configure the Cluster </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../cp4d/cluster-config/gitops-argocd/ class=md-nav__link> GitOps and ArgoCD </a> </li> <li class=md-nav__item> <a href=../../../../cp4d/cluster-config/gitops-config/ class=md-nav__link> Getting started with GitOps </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../cp4d/platform/deployment/ class=md-nav__link> Deployment </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_6_5 type=checkbox id=__nav_4_6_5> <label class=md-nav__link for=__nav_4_6_5> Services <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Services data-md-level=3> <label class=md-nav__title for=__nav_4_6_5> <span class="md-nav__icon md-icon"></span> Services </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_6_5_1 type=checkbox id=__nav_4_6_5_1> <label class=md-nav__link for=__nav_4_6_5_1> Watson Studio <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Watson Studio" data-md-level=4> <label class=md-nav__title for=__nav_4_6_5_1> <span class="md-nav__icon md-icon"></span> Watson Studio </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../cp4d/watson-studio/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../../cp4d/watson-studio/deployment/ class=md-nav__link> Deployment </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_6_5_2 type=checkbox id=__nav_4_6_5_2> <label class=md-nav__link for=__nav_4_6_5_2> Watson Knowledge Catalog <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Watson Knowledge Catalog" data-md-level=4> <label class=md-nav__title for=__nav_4_6_5_2> <span class="md-nav__icon md-icon"></span> Watson Knowledge Catalog </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../cp4d/wkc/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../../cp4d/wkc/deployment/ class=md-nav__link> Deployment </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_7 type=checkbox id=__nav_4_7> <label class=md-nav__link for=__nav_4_7> Cloud Pak for Automation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Cloud Pak for Automation" data-md-level=2> <label class=md-nav__title for=__nav_4_7> <span class="md-nav__icon md-icon"></span> Cloud Pak for Automation </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_7_1 type=checkbox id=__nav_4_7_1> <label class=md-nav__link for=__nav_4_7_1> IBM Process Mining <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="IBM Process Mining" data-md-level=3> <label class=md-nav__title for=__nav_4_7_1> <span class="md-nav__icon md-icon"></span> IBM Process Mining </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../cp4ba/process-mining/overview/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../../cp4ba/process-mining/using/this-guide/ class=md-nav__link> Using this guide </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_7_1_3 type=checkbox id=__nav_4_7_1_3> <label class=md-nav__link for=__nav_4_7_1_3> Create the cluster <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Create the cluster" data-md-level=4> <label class=md-nav__title for=__nav_4_7_1_3> <span class="md-nav__icon md-icon"></span> Create the cluster </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../cp4ba/process-mining/cluster-create/ibm-cloud/ class=md-nav__link> IBM Cloud </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_7_1_4 type=checkbox id=__nav_4_7_1_4> <label class=md-nav__link for=__nav_4_7_1_4> Configure the cluster <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Configure the cluster" data-md-level=4> <label class=md-nav__title for=__nav_4_7_1_4> <span class="md-nav__icon md-icon"></span> Configure the cluster </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../cp4ba/process-mining/cluster-config/gitops-tekton-argocd/ class=md-nav__link> GitOps & ArgoCD </a> </li> <li class=md-nav__item> <a href=../../../../cp4ba/process-mining/cluster-config/gitops-config/ class=md-nav__link> Getting started with GitOps </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_7_1_5 type=checkbox id=__nav_4_7_1_5> <label class=md-nav__link for=__nav_4_7_1_5> Deploy Process Mining <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Deploy Process Mining" data-md-level=4> <label class=md-nav__title for=__nav_4_7_1_5> <span class="md-nav__icon md-icon"></span> Deploy Process Mining </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../cp4ba/process-mining/deployment/ibm-cloud/ class=md-nav__link> IBM Cloud </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> References <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=References data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> References </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../infrastructure/ad/ class=md-nav__link> Architectural Decisions </a> </li> <li class=md-nav__item> <a href=../../../../../references/prerequisites/instructions/ class=md-nav__link> Prerequisites </a> </li> <li class=md-nav__item> <a href=../../../../../references/training/training/ class=md-nav__link> Training </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6> About <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=About data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../overview/whats-new/ class=md-nav__link> What's New </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6_2 type=checkbox id=__nav_6_2> <label class=md-nav__link for=__nav_6_2> Contributing Content <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Contributing Content" data-md-level=2> <label class=md-nav__title for=__nav_6_2> <span class="md-nav__icon md-icon"></span> Contributing Content </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../contribute/githubflow/ class=md-nav__link> GitHub Open Source Contribution </a> </li> <li class=md-nav__item> <a href=../../../../../contribute/documentation/ class=md-nav__link> Running a Local Site Instance </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=#introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=#creating-metrics-app-repo class=md-nav__link> Creating metrics app repo </a> </li> <li class=md-nav__item> <a href=#prepare-queue-manager class=md-nav__link> Prepare Queue Manager </a> </li> <li class=md-nav__item> <a href=#enable-ci-resources class=md-nav__link> Enable CI resources </a> </li> <li class=md-nav__item> <a href=#build-and-deploy-app class=md-nav__link> Build and deploy app </a> </li> <li class=md-nav__item> <a href=#verify-app-deployment class=md-nav__link> Verify app deployment </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.ibm.com/cloudpakbringup/production-deployment-guides/edit/master/docs/guides/cp4i/mq/monitoring/topic3.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=metrics-application>Metrics application<a class=headerlink href=#metrics-application title="Permanent link">&para;</a></h1> <!--- cSpell:ignore qube cntk autoplay allowfullscreen --> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p><strong>Audience</strong>: Architects, Application developers, Administrators</p> <p>In this topic, we're going to:</p> <ul> <li>Revisit our monitoring scenario.</li> <li>Prepare and configure a new application to surface more metrics.</li> <li>Deploy the application.</li> <li>Verify we can see new metrics in Prometheus.</li> </ul> <hr> <h2 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">&para;</a></h2> <p>We have now metrics flowing from our queue manager to Prometheus. But those are the metrics that MQ exposes by default. In some scenarios we would be interested in other metrics beyond the default set. For example, queue depth is an interesting one that many MQ admins look for.</p> <p>In such scenarios we need an auxiliary application. This new application is, in simple terms, an MQ client that connects to our queue manager, retrieves the information of interest, process it and expose it in a metrics endpoint with the right format so Prometheus can read them.</p> <p><img alt="Monitoring scenario" src=../images/mq-monitoring-scenario-complete.png></p> <p>In this topic we are going to review this new application and we are going to deploy it so we can start seeing the new metrics in Prometheus.</p> <hr> <h2 id=creating-metrics-app-repo>Creating metrics app repo<a class=headerlink href=#creating-metrics-app-repo title="Permanent link">&para;</a></h2> <ol> <li> <p><em>Ensure environment variables are set</em></p> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>Ensure you're in the multi-tenancy-gitops-apps terminal window.</p> </div> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>If you're returning to the tutorial after restarting your computer, ensure that the <code>$GIT_ORG</code>, <code>$GIT_BRANCH</code> and <code>$GIT_ROOT</code> environment variables are set.</p> </div> <p>(Replace <your organization name> appropriately:)</p> <div class=highlight><pre><span></span><code><span class=nb>export</span> <span class=nv>GIT_BRANCH</span><span class=o>=</span>master
<span class=nb>export</span> <span class=nv>GIT_ORG</span><span class=o>=</span>&lt;your organization name&gt;
<span class=nb>export</span> <span class=nv>GIT_ROOT</span><span class=o>=</span><span class=nv>$HOME</span>/git/<span class=nv>$GIT_ORG</span>-root
</code></pre></div> <p>You can verify your environment variables as follows:</p> <div class=highlight><pre><span></span><code><span class=nb>echo</span> <span class=nv>$GIT_BRANCH</span>
<span class=nb>echo</span> <span class=nv>$GIT_ORG</span>
<span class=nb>echo</span> <span class=nv>$GIT_ROOT</span>
</code></pre></div> </li> <li> <p><em>Ensure you're logged in to the cluster</em></p> <p>Log into your OCP cluster, substituting the --token and --server parameters with your values:</p> <div class=highlight><pre><span></span><code>oc login --token<span class=o>=</span>&lt;token&gt; --server<span class=o>=</span>&lt;server&gt;
</code></pre></div> <p>If you are unsure of these values, click your user ID in the OpenShift web console and select "Copy Login Command".</p> </li> <li> <p><em>Go to your root folder</em> </p> <p>In the terminal let's move to our root folder:</p> <div class=highlight><pre><span></span><code><span class=nb>cd</span> <span class=nv>$GIT_ROOT</span>
</code></pre></div> </li> <li> <p><em>Fork mq-metric-samples application repository</em></p> <p>Navigate to the <code>mq-metric-samples</code> repository that can be found in the <code>ibm-messaging</code> organization at <a href=https://github.com/ibm-messaging/mq-metric-samples>https://github.com/ibm-messaging/mq-metric-samples</a> and fork it into your organization.</p> </li> <li> <p><em>Clone the fork to your local machine</em></p> <div class=highlight><pre><span></span><code>git clone https://github.com/<span class=nv>$GIT_ORG</span>/mq-metric-samples.git
</code></pre></div> </li> <li> <p><em>Change to the local clone's folder</em></p> <div class=highlight><pre><span></span><code><span class=nb>cd</span> mq-metric-samples
</code></pre></div> </li> <li> <p><em>Review the application source directories</em></p> <div class=highlight><pre><span></span><code>tree -L <span class=m>1</span>
</code></pre></div> <p>The following diagram shows the directory structure for the metrics application:</p> <div class="no-copy highlight"><pre><span></span><code>.
 CHANGELOG.md
 CLA.md
 Dockerfile.build
 Dockerfile.run
 LICENSE
 README.md
 cmd
 config.common.yaml
 cp4i
 dspmqrtj
 go.mod
 go.sum
 pkg
 scripts
 vendor
</code></pre></div> <p>This repository contains a collection of IBM MQ monitoring agents that utilize the IBM MQ golang metric packages to provide programs that can be used with existing monitoring technologies such as Prometheus, AWS CloudWatch, etc. </p> <p>In this structure note the following folders:</p> <ul> <li><code>cmd</code> contains the different code bases for different solutions. The case of interest here is <code>mq_prometheus</code> that will perform the export of queue manager data into a Prometheus data set.</li> <li><code>cp4i</code> contains yaml resources and helm charts that will help us to deploy the application in our cluster.</li> <li><code>scripts</code> contains functionality that will help to build the container images on our local environments.</li> </ul> </li> <li> <p><em>Review the ConfigMap template</em></p> <p>Let's have a look to the ConfigMap template. The ConfigMap that is provided contains all the parameters that the metrics application is going to use to connect to the queue manager. Issue the following command to check the template:</p> <div class=highlight><pre><span></span><code>cat cp4i/chart/base/templates/configmap.yaml
</code></pre></div> <p>You will see the following output:</p> <div class=highlight><pre><span></span><code><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v1</span><span class=w></span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ConfigMap</span><span class=w></span>
<span class=nt>metadata</span><span class=p>:</span><span class=w></span>
<span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{{</span><span class=w> </span><span class=nv>.Values.name</span><span class=w> </span><span class="p p-Indicator">}}</span><span class=w></span>
<span class=nt>data</span><span class=p>:</span><span class=w></span>
<span class=nt>IBMMQ_CONNECTION_QUEUEMANAGER</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{{</span><span class=w> </span><span class=nv>.Values.configmap.QM | quote</span><span class=w> </span><span class="p p-Indicator">}}</span><span class=w></span>
<span class=nt>IBMMQ_CONNECTION_CONNNAME</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{{</span><span class=w> </span><span class=nv>.Values.configmap.CONNECTION_NAME | quote</span><span class=w> </span><span class="p p-Indicator">}}</span><span class=w></span>
<span class=nt>IBMMQ_CONNECTION_CHANNEL</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{{</span><span class=w> </span><span class=nv>.Values.configmap.CHANNEL | quote</span><span class=w> </span><span class="p p-Indicator">}}</span><span class=w></span>
<span class=nt>IBMMQ_OBJECTS_QUEUES</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{{</span><span class=w> </span><span class=nv>.Values.configmap.QUEUES | quote</span><span class=w> </span><span class="p p-Indicator">}}</span><span class=w></span>
<span class=nt>IBMMQ_OBJECTS_SUBSCRIPTIONS</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{{</span><span class=w> </span><span class=nv>.Values.configmap.SUBSCRIPTIONS | quote</span><span class=w> </span><span class="p p-Indicator">}}</span><span class=w></span>
<span class=nt>IBMMQ_OBJECTS_TOPICS</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{{</span><span class=w> </span><span class=nv>.Values.configmap.TOPICS | quote</span><span class=w> </span><span class="p p-Indicator">}}</span><span class=w></span>
<span class=nt>IBMMQ_GLOBAL_USEPUBLICATIONS</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{{</span><span class=w> </span><span class=nv>.Values.configmap.USE_PUBLICATIONS | quote</span><span class=w> </span><span class="p p-Indicator">}}</span><span class=w></span>
<span class=nt>IBMMQ_GLOBAL_USEOBJECTSTATUS</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{{</span><span class=w> </span><span class=nv>.Values.configmap.USE_OBJECT_STATUS | quote</span><span class=w> </span><span class="p p-Indicator">}}</span><span class=w></span>
<span class=nt>IBMMQ_GLOBAL_CONFIGURATIONFILE</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{{</span><span class=w> </span><span class=nv>.Values.configmap.CONFIGURATION_FILE | quote</span><span class=w> </span><span class="p p-Indicator">}}</span><span class=w></span>
<span class=nt>IBMMQ_GLOBAL_LOGLEVEL</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{{</span><span class=w> </span><span class=nv>.Values.configmap.LOG_LEVEL | quote</span><span class=w> </span><span class="p p-Indicator">}}</span><span class=w></span>
</code></pre></div> <p>We can see here the <code>CONNECTION_NAME</code> that is using the service string to establish the connection and it is going to use <code>MONITORING_CHL</code> channel to connect. </p> </li> <li> <p><em>Update values</em></p> <p>Let's have a look to the <code>values.yaml</code> that will be used with the Helm templates:</p> <div class=highlight><pre><span></span><code>cat cp4i/chart/base/values.yaml
</code></pre></div> <p>We will focus in the values for the ConfigMap. If we check at the end of the output, we will see the default values for the Config Map:</p> <div class=highlight><pre><span></span><code><span class=nn>...</span><span class=w></span>
<span class=nt>configmap</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>QM</span><span class=p>:</span><span class=w> </span><span class=s>&quot;QM1&quot;</span><span class=w></span>
<span class=w>  </span><span class=nt>CONNECTION_NAME</span><span class=p>:</span><span class=w> </span><span class=s>&quot;qm-dev-ibm-mq.dev.svc.cluster.local(1414)&quot;</span><span class=w></span>
<span class=w>  </span><span class=nt>CHANNEL</span><span class=p>:</span><span class=w> </span><span class=s>&quot;MONITORING_CHL&quot;</span><span class=w></span>
<span class=w>  </span><span class=nt>QUEUES</span><span class=p>:</span><span class=w> </span><span class=s>&quot;!SYSTEM.*,!AMQ.*,*&quot;</span><span class=w></span>
<span class=w>  </span><span class=nt>SUBSCRIPTIONS</span><span class=p>:</span><span class=w> </span><span class=s>&quot;!$SYS*&quot;</span><span class=w></span>
<span class=w>  </span><span class=nt>TOPICS</span><span class=p>:</span><span class=w> </span><span class=s>&quot;!*&quot;</span><span class=w></span>
<span class=w>  </span><span class=nt>USE_PUBLICATIONS</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class=w></span>
<span class=w>  </span><span class=nt>USE_OBJECT_STATUS</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class=w></span>
<span class=w>  </span><span class=nt>CONFIGURATION_FILE</span><span class=p>:</span><span class=w> </span><span class=s>&quot;&quot;</span><span class=w></span>
<span class=w>  </span><span class=nt>LOG_LEVEL</span><span class=p>:</span><span class=w> </span><span class=s>&quot;INFO&quot;</span><span class=w></span>
</code></pre></div> <p>We need to ensure the <code>CONNECTION_NAME</code> is correct for our cluster and we need to get the <code>Name</code> of the service so we can update the configuration. In our case this is <code>qm1-ibm-mq</code> so we will update the <code>values.yaml</code> file to have the following:</p> <div class=highlight><pre><span></span><code><span class=nn>...</span><span class=w></span>
<span class=nt>configmap</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>QM</span><span class=p>:</span><span class=w> </span><span class=s>&quot;QM1&quot;</span><span class=w></span>
<span class=hll><span class=w>  </span><span class=nt>CONNECTION_NAME</span><span class=p>:</span><span class=w> </span><span class=s>&quot;qm1-ibm-mq.dev.svc.cluster.local(1414)&quot;</span><span class=w></span>
</span><span class=w>  </span><span class=nt>CHANNEL</span><span class=p>:</span><span class=w> </span><span class=s>&quot;MONITORING_CHL&quot;</span><span class=w></span>
<span class=w>  </span><span class=nt>QUEUES</span><span class=p>:</span><span class=w> </span><span class=s>&quot;!SYSTEM.*,!AMQ.*,*&quot;</span><span class=w></span>
<span class=w>  </span><span class=nt>SUBSCRIPTIONS</span><span class=p>:</span><span class=w> </span><span class=s>&quot;!$SYS*&quot;</span><span class=w></span>
<span class=w>  </span><span class=nt>TOPICS</span><span class=p>:</span><span class=w> </span><span class=s>&quot;!*&quot;</span><span class=w></span>
<span class=w>  </span><span class=nt>USE_PUBLICATIONS</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class=w></span>
<span class=w>  </span><span class=nt>USE_OBJECT_STATUS</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class=w></span>
<span class=w>  </span><span class=nt>CONFIGURATION_FILE</span><span class=p>:</span><span class=w> </span><span class=s>&quot;&quot;</span><span class=w></span>
<span class=w>  </span><span class=nt>LOG_LEVEL</span><span class=p>:</span><span class=w> </span><span class=s>&quot;INFO&quot;</span><span class=w></span>
</code></pre></div> </li> <li> <p><em>Commit and push the changes</em></p> <div class=highlight><pre><span></span><code>git add .
git commit -s -m <span class=s2>&quot;Update connection name&quot;</span>
git push origin <span class=nv>$GIT_BRANCH</span>
</code></pre></div> </li> </ol> <p>We have now the metrics application ready.</p> <hr> <h2 id=prepare-queue-manager>Prepare Queue Manager<a class=headerlink href=#prepare-queue-manager title="Permanent link">&para;</a></h2> <p>Now we need to get our queue manager ready. In the previous section we saw that <code>MONITORING_CHL</code> channel was going to be used by the metrics app to connect to our queue manager. We need to update <code>config.mqsc</code> to make this channel available.</p> <ol> <li> <p><em>Ensure environment variables are set</em></p> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>Ensure that the <code>$GIT_BRANCH_QM1</code> environment variable is set.</p> </div> <div class=highlight><pre><span></span><code><span class=nb>export</span> <span class=nv>GIT_BRANCH_QM1</span><span class=o>=</span>qm1-<span class=nv>$GIT_ORG</span>
</code></pre></div> <p>You can verify your environment variable as follows:</p> <div class=highlight><pre><span></span><code><span class=nb>echo</span> <span class=nv>$GIT_BRANCH_QM1</span>
</code></pre></div> </li> <li> <p><em>Go to your <code>mq-infra</code> repo</em></p> <p>Switch now to the terminal where you are working with <code>mq-infra</code> repository and ensure you are in the correct folder:</p> <div class=highlight><pre><span></span><code><span class=nb>cd</span> <span class=nv>$GIT_ROOT</span>/mq-infra
</code></pre></div> </li> <li> <p><em>Switch to $GIT_BRANCH_QM1</em></p> <p>We are about to make an update in MQSC configuration, so we will work in the branch we created during the building of the queue manager.</p> <div class=highlight><pre><span></span><code>git checkout <span class=nv>$GIT_BRANCH_QM1</span>
</code></pre></div> </li> <li> <p><em>Update <code>config.mqsc</code></em></p> <p>The <code>config.mqsc</code> is located at <code>chart/base/config/config.mqsc</code> and it already contains the configurations needed for monitoring purposes. Uncomment the lines that define the <code>MONITORING_CHL</code> and the security for it removing the <code>*</code> characters.</p> <div class=highlight><pre><span></span><code>DEFINE QLOCAL<span class=o>(</span>IBM.DEMO.Q<span class=o>)</span> BOQNAME<span class=o>(</span>IBM.DEMO.Q.BOQ<span class=o>)</span> BOTHRESH<span class=o>(</span><span class=m>3</span><span class=o>)</span> REPLACE
DEFINE QLOCAL<span class=o>(</span>IBM.DEMO.Q.BOQ<span class=o>)</span> REPLACE
* Use a different dead letter queue, <span class=k>for</span> undeliverable messages
DEFINE QLOCAL<span class=o>(</span><span class=s1>&#39;DEV.DEAD.LETTER.QUEUE&#39;</span><span class=o>)</span> REPLACE
ALTER QMGR DEADQ<span class=o>(</span><span class=s1>&#39;DEV.DEAD.LETTER.QUEUE&#39;</span><span class=o>)</span>
DEFINE CHANNEL<span class=o>(</span><span class=s1>&#39;IBM.APP.SVRCONN&#39;</span><span class=o>)</span> CHLTYPE<span class=o>(</span>SVRCONN<span class=o>)</span>
ALTER QMGR CHLAUTH <span class=o>(</span>DISABLED<span class=o>)</span>
<span class=hll>* DEFINE CHANNEL<span class=o>(</span><span class=s1>&#39;MONITORING_CHL&#39;</span><span class=o>)</span> CHLTYPE<span class=o>(</span>SVRCONN<span class=o>)</span>
</span><span class=hll>* SET CHLAUTH<span class=o>(</span>MONITORING_CHL<span class=o>)</span> TYPE<span class=o>(</span>BLOCKUSER<span class=o>)</span> USERLIST<span class=o>(</span>NOBODY<span class=o>)</span>
</span>REFRESH SECURITY TYPE<span class=o>(</span>CONNAUTH<span class=o>)</span>
</code></pre></div> </li> <li> <p><em>Push the changes</em></p> <p>The configuration is ready and we need to get it into our Git repo.</p> <div class=highlight><pre><span></span><code>git add .
git commit -s -m <span class=s2>&quot;Enable monitoring channel&quot;</span>
git push origin <span class=nv>$GIT_BRANCH_QM1</span>
</code></pre></div> </li> <li> <p><em>Check<code>mq-infra-dev</code> pipeline is running</em></p> <p>If you have setup the webhooks for the <code>mq-infra</code> repository following the <a href=../../qmgr-pipeline/topic4/ >Continuous updates</a> topic, a new pipeline run is running now. If you skipped that section, you will need to trigger a new run manually.</p> <p>Once the pipeline finishes and the new version of the queue manager is deployed, verify the new channel is available. Access the MQ console and in the <code>Communication</code> tab, <code>App channels</code> section, you will see the <code>MONITORING_CHL</code> listed.</p> <p><img alt="MQ Console Monitoring Channel" src=../images/mq-console-monitoring-chl.png></p> </li> </ol> <hr> <h2 id=enable-ci-resources>Enable CI resources<a class=headerlink href=#enable-ci-resources title="Permanent link">&para;</a></h2> <p>Let's now enable and review the application pipeline and a task that will build our metrics app image in the pipeline.</p> <ol> <li> <p><em>Go to <code>multi-tenancy-gitops-apps</code> folder</em></p> <p>For this section, we return to the <strong>terminal window</strong> we used in previous chapters for interacting with the GitOps repository. Open a new terminal window for the <code>multi-tenancy-gitops-apps</code> repository if necessary.</p> <div class=highlight><pre><span></span><code><span class=nb>cd</span> <span class=nv>$GIT_ROOT</span>/multi-tenancy-gitops-apps
</code></pre></div> </li> <li> <p><em>Check the resources</em></p> <p>In this repo there are a pipeline and a task resources that we will use to deploy our metrics application:</p> <ul> <li>The pipeline resource is defined in <code>mq/environments/ci/pipelines/mq-metric-samples-dev-pipeline.yaml</code></li> <li>The task resource is defined in <code>mq/environments/ci/tasks/mq-metrics-build-tag-push.yaml</code></li> </ul> <p>Feel free to review these resources in depth.</p> </li> <li> <p><em>Update kustomize</em></p> <p>We need to get those resources deployed in our cluster. We just need to uncomment the highlighted lines in <code>mq/environments/ci/kustomization.yaml</code> so ArgoCD can deploy them. </p> <div class="no-copy highlight"><pre><span></span><code><span class=nt>resources</span><span class=p>:</span><span class=w></span>
<span class=c1>#- certificates/ci-mq-client-certificate.yaml</span><span class=w></span>
<span class=c1>#- certificates/ci-mq-server-certificate.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">configmaps/gitops-repo-configmap.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">eventlisteners/cntk-event-listener.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">triggerbindings/cntk-binding.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">triggertemplates/mq-infra-dev.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">triggertemplates/mq-spring-app-dev.yaml</span><span class=w></span>
<span class=hll><span class=c1>#- pipelines/mq-metric-samples-dev-pipeline.yaml</span><span class=w></span>
</span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">pipelines/ibm-test-pipeline-for-dev.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">pipelines/ibm-test-pipeline-for-stage.yaml</span><span class=w></span>
<span class=c1>#- pipelines/java-maven-dev-pipeline.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">pipelines/mq-pipeline-dev.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">pipelines/mq-spring-app-dev-pipeline.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">roles/custom-pipeline-sa-clusterrole.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">roles/custom-pipeline-sa-role.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">roles/custom-ci-pipeline-sa-rolebinding.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">roles/custom-dev-pipeline-sa-rolebinding.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">roles/custom-staging-pipeline-sa-rolebinding.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">roles/custom-prod-pipeline-sa-rolebinding.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">routes/cntk-route.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">secrets/artifactory-access-secret.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">secrets/git-credentials-secret.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">secrets/ibm-entitled-registry-credentials-secret.yaml</span><span class=w></span>
<span class=c1>#- secrets/mq-client-jks-password-secret.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasks/10-gitops.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasks/10-gitops-for-mq.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasks/10-gitops-promotion.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasks/11-app-name.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasks/12-functional-tests.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasks/13-jmeter-performance-test.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasks/13-cphtestp-performance-test.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasks/4-smoke-tests-mq.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasks/4-smoke-tests.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasks/ibm-build-tag-push-v2-6-13.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasks/ibm-helm-release-v2-6-13.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasks/ibm-img-release-v2-6-13.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasks/ibm-img-scan-v2-6-13.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasks/ibm-java-maven-test-v2-6-13.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasks/ibm-setup-v2-6-13.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasks/ibm-tag-release-v2-6-13.yaml</span><span class=w></span>
<span class=hll><span class=c1>#- tasks/mq-metrics-build-tag-push.yaml</span><span class=w></span>
</span>
<span class=c1># Automated promotion process triggers</span><span class=w></span>

<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">triggertemplates/mq-infra-dev-triggertemplate.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">eventlisteners/mq-infra-dev-eventlistener.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">routes/mq-infra-dev-route.yaml</span><span class=w></span>

<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">triggertemplates/mq-spring-app-dev-triggertemplate.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">eventlisteners/mq-spring-app-dev-eventlistener.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">routes/mq-spring-app-dev-route.yaml</span><span class=w></span>

<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">triggertemplates/mq-infra-stage-triggertemplate.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">eventlisteners/mq-infra-stage-eventlistener.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">routes/mq-infra-stage-route.yaml</span><span class=w></span>

<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">triggertemplates/mq-spring-app-stage-triggertemplate.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">eventlisteners/mq-spring-app-stage-eventlistener.yaml</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">routes/mq-spring-app-stage-route.yaml</span><span class=w></span>
</code></pre></div> </li> <li> <p><em>Push the changes</em></p> <p>With those lines uncommented, push the changes:</p> <div class=highlight><pre><span></span><code>git add .
git commit -s -m <span class=s2>&quot;Enable monitoring application pipeline and build task&quot;</span>
git push origin <span class=nv>$GIT_BRANCH</span>
</code></pre></div> <p>Wait until ArgoCD deploys them. You can check how the new resources appear in the <code>apps-mq-rest-ci-1</code> ArgoCD application.</p> <p><img alt="ArgoCD resources" src=../images/argocd-mq-metric-resources.png></p> </li> </ol> <hr> <h2 id=build-and-deploy-app>Build and deploy app<a class=headerlink href=#build-and-deploy-app title="Permanent link">&para;</a></h2> <p>The pipeline to build the metrics application is now available in OpenShift. We are going to run it to obtain the image that will be deployed by ArgoCD.</p> <ol> <li> <p><em>Review the pre-configured pipeline</em></p> <p>Open the OpenShift console and navigate to <code>Pipelines &gt; Pipelines</code>.</p> <p>You will want to select the <code>ci</code> Project from the dropdown at the top of the page.</p> <p>Click the <code>mq-metric-samples-dev</code> Pipeline to view the metrics application build pipeline.</p> <p><img alt="MQ metric samples pipeline" src=../images/mq-metric-samples-dev-pipeline.png></p> <p>The code is checked out and then a build task uses the code to compile the application and embed it into a container image. Then the code is tagged and the image released. Finally, the <code>multi-tenancy-gitops-apps</code> repository is updated to reflect the new desired estate.</p> </li> <li> <p><em>Kickoff a pipeline run</em></p> <p>From the <strong>Actions</strong> dropdown menu in the upper-right corner, select <strong>Start</strong>.</p> <p><img alt="MQ metric samples pipeline start dialog" src=../images/mq-metrics-app-pipeline-start.png style=max-height:900px></p> <p>Configure the run as follows:</p> <ul> <li>Set <code>git-url</code> to your fork of the <code>mq-metric-samples</code> repository</li> <li>Set <code>git-revision</code> to <code>master</code>.</li> <li>Set <code>scan-image: false</code> (temporary fix while issues with UBI are resolved)</li> </ul> <p>Click <strong>Start</strong> and wait! Keep checking until all steps have completed.</p> </li> <li> <p><em>Re-merging local clone to view updated app resources in GitOps repository</em></p> <p>The <code>mq-metric-samples-dev</code> pipeline run updated the GitOps repository with the application kubernetes resources. This means that our local clone of the GitOps repository is one commit behind GitHub. Before we can push any more changes to the GitOps repository, we must re-merge our local clone with GitHub.</p> <p><strong>Return to the terminal window</strong> you're using for the <code>multi-tenancy-gitops-apps</code> GitOps apps repository. (Rather than the terminal window you're using for the <code>mq-metric-samples</code> source repository.)</p> <div class=highlight><pre><span></span><code>git fetch origin
git merge origin/<span class=nv>$GIT_BRANCH</span>
</code></pre></div> <p>which shows that <div class="no-copy highlight"><pre><span></span><code>Updating e3a855d..3b9a70d
Fast-forward
mq/environments/mq-metric-samples/overlays/dev/mq-metric-samples/configmap.yaml      <span class=p>|</span> <span class=m>17</span> +++++++++++++++++
mq/environments/mq-metric-samples/overlays/dev/mq-metric-samples/deployment.yaml     <span class=p>|</span> <span class=m>40</span> ++++++++++++++++++++++++++++++++++++++++
mq/environments/mq-metric-samples/overlays/dev/mq-metric-samples/role.yaml           <span class=p>|</span> <span class=m>10</span> ++++++++++
mq/environments/mq-metric-samples/overlays/dev/mq-metric-samples/rolebinding.yaml    <span class=p>|</span> <span class=m>13</span> +++++++++++++
mq/environments/mq-metric-samples/overlays/dev/mq-metric-samples/route.yaml          <span class=p>|</span> <span class=m>16</span> ++++++++++++++++
mq/environments/mq-metric-samples/overlays/dev/mq-metric-samples/secret.yaml         <span class=p>|</span> <span class=m>10</span> ++++++++++
mq/environments/mq-metric-samples/overlays/dev/mq-metric-samples/service.yaml        <span class=p>|</span> <span class=m>24</span> ++++++++++++++++++++++++
mq/environments/mq-metric-samples/overlays/dev/mq-metric-samples/serviceaccount.yaml <span class=p>|</span>  <span class=m>6</span> ++++++
mq/environments/mq-metric-samples/overlays/dev/mq-metric-samples/servicemonitor.yaml <span class=p>|</span> <span class=m>19</span> +++++++++++++++++++
<span class=m>9</span> files changed, <span class=m>155</span> insertions<span class=o>(</span>+<span class=o>)</span>
create mode <span class=m>100644</span> mq/environments/mq-metric-samples/overlays/dev/mq-metric-samples/configmap.yaml
create mode <span class=m>100644</span> mq/environments/mq-metric-samples/overlays/dev/mq-metric-samples/deployment.yaml
create mode <span class=m>100644</span> mq/environments/mq-metric-samples/overlays/dev/mq-metric-samples/role.yaml
create mode <span class=m>100644</span> mq/environments/mq-metric-samples/overlays/dev/mq-metric-samples/rolebinding.yaml
create mode <span class=m>100644</span> mq/environments/mq-metric-samples/overlays/dev/mq-metric-samples/route.yaml
create mode <span class=m>100644</span> mq/environments/mq-metric-samples/overlays/dev/mq-metric-samples/secret.yaml
create mode <span class=m>100644</span> mq/environments/mq-metric-samples/overlays/dev/mq-metric-samples/service.yaml
create mode <span class=m>100644</span> mq/environments/mq-metric-samples/overlays/dev/mq-metric-samples/serviceaccount.yaml
create mode <span class=m>100644</span> mq/environments/mq-metric-samples/overlays/dev/mq-metric-samples/servicemonitor.yaml
</code></pre></div></p> <p>We're now in a consistent state with the GitOps apps repository.</p> </li> <li> <p><em>The ArgoCD application for <code>MQ metric samples application</code></em></p> <p><code>MQ metric samples application</code> has its deployment to the cluster managed by a dedicated ArgoCD application called <code>dev-mq-metric-samples-instance</code>. This follows the <strong>separation of concerns</strong> pattern where one ArgoCD application manages a set of related Kubernetes resources deployed to a cluster; in this case, all those resources associated with <code>MQ metric samples application</code> in the <code>dev</code> namespace.</p> <p>Issue the following command to show the ArgoCD application details:</p> <div class=highlight><pre><span></span><code>cat mq/config/argocd/dev/dev-mq-metric-samples-instance.yaml
</code></pre></div> <p>which shows a YAML file typical of those we've seen before:</p> <div class="no-copy highlight"><pre><span></span><code><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span><span class=w></span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Application</span><span class=w></span>
<span class=nt>metadata</span><span class=p>:</span><span class=w></span>
<span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dev-mq-metric-samples-instance</span><span class=w></span>
<span class=nt>annotations</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>argocd.argoproj.io/sync-wave</span><span class=p>:</span><span class=w> </span><span class=s>&quot;300&quot;</span><span class=w></span>
<span class=nt>finalizers</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">resources-finalizer.argocd.argoproj.io</span><span class=w></span>
<span class=nt>spec</span><span class=p>:</span><span class=w></span>
<span class=nt>destination</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dev</span><span class=w></span>
<span class=w>  </span><span class=nt>server</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://kubernetes.default.svc</span><span class=w></span>
<span class=nt>project</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">applications</span><span class=w></span>
<span class=nt>source</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mq/environments/mq-metric-samples/overlays/dev</span><span class=w></span>
<span class=w>  </span><span class=nt>repoURL</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/cloud-native-toolkit-demos/multi-tenancy-gitops-apps.git</span><span class=w></span>
<span class=w>  </span><span class=nt>targetRevision</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">master</span><span class=w></span>
<span class=nt>syncPolicy</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>automated</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>prune</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class=w></span>
<span class=w>    </span><span class=nt>selfHeal</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class=w></span>
</code></pre></div> <p>See how the application resources are referenced by <code>path: mq/environments/mq-metric-samples/overlays/dev</code>:</p> <div class="no-copy highlight"><pre><span></span><code>mq/environments/mq-metric-samples/overlays/dev/
 configmap
  configmap.yaml
 kustomization.yaml
 mq-metric-samples
</code></pre></div> <p>The ArgoCD application applies these resources to the cluster to instantiate <code>MQ metric samples application</code> as a set of cluster resources.</p> </li> <li> <p><em>Look at active <code>MQ metric samples application</code> ArgoCD application</em></p> <p>Let's examine <code>MQ metric samples application</code> and its Kubernetes resources using the ArgoCD UI.</p> <p>In the ArgoCD UI search the <strong>Applications</strong> view with the keyword <code>mq-metric-samples</code>:</p> <p>(<em>You may need to launch the ArgoCD UI again. Refer to <a href=../../cluster-config/gitops-tekton-argocd/ >these instructions</a>.</em>)</p> <p><img alt="ArgoCD application" src=../images/dev-mq-metric-samples-argocd-app.png style=max-height:600px></p> <p>We can now see the below ArgoCD Application:</p> <ul> <li>A new <code>dev-mq-metric-samples-instance</code> ArgoCD application that is managing <code>mq-metric-samples</code> resources deployed to the cluster.</li> </ul> <div class="admonition caution"> <p class=admonition-title>Metrics application configuration still not finished</p> <p>At this moment the application is deployed but not healthy. This is expected. Continue with the last two steps to finish the configuration.</p> </div> </li> <li> <p><em>Give permissions to service account</em></p> <p>As part of the set of resources deployed, the application runs as a service account <code>mq-metric-samples</code>. At this moment the pod is not capable to run due to lack of permissions and we need to provide them issuing the following command:</p> <div class=highlight><pre><span></span><code>oc adm policy add-scc-to-user anyuid -z mq-metric-samples
</code></pre></div> <div class="admonition caution"> <p class=admonition-title>First iteration</p> <p>Take into account that this is the first iteration for the MQ monitoring where security aspects has not been addressed yet.</p> </div> </li> <li> <p><em>Check permissions</em></p> <p>Now issue the following command to check if the pod is allowed by <code>anyuid</code>. Make sure you use the right name for the pod as this name contains a component that is randomized, so it will be different from the one reflected here:</p> <div class=highlight><pre><span></span><code>oc get pod mq-metric-samples-6545f985f-6jjr8-o yaml <span class=p>|</span> oc adm policy scc-subject-review -f -
</code></pre></div> <p>You should see the following output:</p> <div class="no-copy highlight"><pre><span></span><code>RESOURCE                                ALLOWED BY
Pod/mq-metric-samples-6545f985f-6jjr8   anyuid
</code></pre></div> </li> <li> <p><em>Reboot the pod</em></p> <p>Now that the service account has the permissions issued, let's remove the pod to trigger its recreation so the new pod will run under the new permission we gave in the previous steps.</p> <p><img alt="MQ metric samples pod deletion" src=../images/mq-metric-samples-delete-pod.png style=max-height:900px></p> <p>Go to the OpenShift web console. Access <code>Workloads &gt; Pods</code> section on the left menu and ensure you are in the <code>dev</code> project. You will see the metrics app pod. Click on the three dots menu on the right-hand side and select <code>Delete Pod</code>. Immediately a new pod will be created and the new pod now shows as Running.</p> </li> <li> <p><em>View the new</em> <code>MQ metric samples application</code> <em>Kubernetes resources</em></p> <p>Back to ArgoCD UI, we can look at the deployed instance of <code>mq-metric-samples</code> and its dependent kubernetes resources.</p> <p>Click on the <code>dev-mq-metric-samples-instance</code> ArgoCD application:</p> <p><img alt="MQ metric samples ArgoCD application" src=../images/mq-metric-samples-argocd-app.png style=max-height:900px></p> </li> </ol> <hr> <h2 id=verify-app-deployment>Verify app deployment<a class=headerlink href=#verify-app-deployment title="Permanent link">&para;</a></h2> <ol> <li> <p><em>Review the deployed application</em></p> <p>The application is deployed within the cluster using a <code>deployment</code> manifest. The deployment creates a <code>replica set</code> to manage the application's pod.</p> <p>A <code>service</code> is also created to manage the port, and a <code>route</code> allows external connectivity to the application via the service.</p> <p>Also a <code>servicemonitor</code> is created. This service allows the communication between the application and Prometheus.</p> <p>This is the <code>deployment</code> for the application, where we can see 1 pod has been created:</p> <p><img alt="MQ metric samples deployment" src=../images/mq-metric-samples-deployment.png></p> <p>You can also view the <code>deployment</code> from the command line:</p> <div class=highlight><pre><span></span><code>oc project dev
oc describe deployment mq-metric-samples
</code></pre></div> <p>The application writes logs to stdout. These can be viewed from the command line. First of all find the name of the running <code>mq-metric-samples</code> pod:</p> <div class=highlight><pre><span></span><code>oc get pods -l app.kubernetes.io/name<span class=o>=</span>mq-metric-samples
</code></pre></div> <p>Using the name of the running <code>mq-metric-samples</code> pod, the following commands displays its logs:</p> <div class=highlight><pre><span></span><code>oc logs mq-metric-samples-6545f985f-vxh82
</code></pre></div> <p>Note that since we deleted the firs pod, the new one has a different name.</p> </li> <li> <p><em>Review the application's service</em></p> <p>This shows the corresponding <code>service</code>, where we can see the application's port 9157 (this is the metrics port) inside the application pod is being mapped to <code>port 9157</code> at the cluster level:</p> <p><img alt="MQ metric samples service" src=../images/mq-metric-samples-service.png></p> <p>You can also view the <code>service</code> from the command line:</p> <div class=highlight><pre><span></span><code>oc describe service mq-metric-samples
</code></pre></div> </li> <li> <p><em>Review the application's servicemonitor</em></p> <p>This shows the <code>servicemonitor</code> used to map the application metrics port so Prometheus is able to collect the metrics. Here, the interesting information can be viewed in the yaml view:</p> <p><img alt="MQ metric samples servicemonitor" src=../images/mq-metric-samples-servicemonitor.png></p> <p>You can also view the <code>servicemonitor</code> from the command line:</p> <div class=highlight><pre><span></span><code>oc describe servicemonitor mq-metric-samples
</code></pre></div> <p>Prometheus follows a <em>pull</em> approach when we talk about the way metrics are collected. Servicemonitor resources is the way Prometheus monitoring system can find the endpoints to collect metrics. Let's look at the following lines in the servicemonitor yaml:</p> <div class="no-copy highlight"><pre><span></span><code><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w></span>
<span class=w>      </span><span class=nt>app.kubernetes.io/instance</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mq-metric-samples</span><span class=w></span>
<span class=w>      </span><span class=nt>app.kubernetes.io/name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mq-metric-samples</span><span class=w></span>
</code></pre></div> <p>This selector is trying to find the resources that contains the labels listed. If we have a look to our deployment labels we will see:</p> <div class="no-copy highlight"><pre><span></span><code><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mq-metric-samples</span><span class=w></span>
<span class=hll><span class=w>    </span><span class=nt>app.kubernetes.io/instance</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mq-metric-samples</span><span class=w></span>
</span><span class=hll><span class=w>    </span><span class=nt>app.kubernetes.io/name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mq-metric-samples</span><span class=w></span>
</span><span class=w>    </span><span class=nt>app.kubernetes.io/part-of</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">inventory</span><span class=w></span>
<span class=w>    </span><span class=nt>argo.cntk/instance</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dev-mq-metric-samples-instance</span><span class=w></span>
<span class=w>    </span><span class=nt>helm.sh/chart</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mq-metric-samples-1.0.0-rcv5.2.8</span><span class=w></span>
</code></pre></div> <p>This is the way the monitoring system is finding the endpoint exposed by the metrics app.</p> </li> <li> <p><em>Review the application's route</em></p> <p>Finally the <code>route</code> shows the external URL (location) we can use to inspect the metric values exported by the application in the moment of hitting the URL:</p> <p><img alt="MQ metric samples route" src=../images/mq-metric-samples-route.png></p> <p>You can also view the <code>route</code> from the command line:</p> <div class=highlight><pre><span></span><code>oc describe route mq-metric-samples
</code></pre></div> </li> <li> <p><em>Check the application is running</em></p> <p>Using the <code>location</code> value from the <code>route</code> we can call the application to check its exporting metrics adding <code>/metrics</code> to the route:</p> <div class=highlight><pre><span></span><code><span class=nb>export</span> <span class=nv>APP_URL</span><span class=o>=</span><span class=k>$(</span>oc get route -n dev mq-metric-samples -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s2>&quot;{.spec.host}&quot;</span><span class=k>)</span>
curl -X GET https://<span class=nv>$APP_URL</span>/metrics
</code></pre></div> <p>The output is similar to the following.</p> <div class="no-copy highlight"><pre><span></span><code># HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.
# TYPE go_gc_duration_seconds summary
go_gc_duration_seconds{quantile=&quot;0&quot;} 7.465e-05
go_gc_duration_seconds{quantile=&quot;0.25&quot;} 8.9893e-05
go_gc_duration_seconds{quantile=&quot;0.5&quot;} 0.00015446
go_gc_duration_seconds{quantile=&quot;0.75&quot;} 0.000577563
go_gc_duration_seconds{quantile=&quot;1&quot;} 0.00205311
go_gc_duration_seconds_sum 0.003462792
go_gc_duration_seconds_count 7
# HELP go_goroutines Number of goroutines that currently exist.
# TYPE go_goroutines gauge
go_goroutines 13
# HELP go_info Information about the Go environment.
# TYPE go_info gauge
go_info{version=&quot;go1.16.12&quot;} 1
...
</code></pre></div> <p>The output here has been truncated but if you examine the whole result you will see that the information shown are the metrics that are being exposed and you are seeing the values at the moment of visiting the URL. Further down the output you will see the new MQ metrics such as <code>ibmmq_queue_depth</code> or <code>ibmmq_queue_oldest_message_age</code>. </p> </li> <li> <p><em>Review one of the exported metrics</em></p> <p>If we examine one of these lines, we can see something like:</p> <div class="no-copy highlight"><pre><span></span><code>ibmmq_queue_depth{description=&quot;-&quot;,platform=&quot;UNIX&quot;,qmgr=&quot;QM1&quot;,queue=&quot;IBM.DEMO.Q&quot;,usage=&quot;NORMAL&quot;} 0
</code></pre></div> <p>The metric name is <code>ibmmq_queue_depth</code>. This metric consists in a set of values. Under this metric name all the queue depths of the queue manager are recorded. </p> <p>Between brackets we can see a comma separated list of key-value pairs. These are attributes that defines the metric for each individual queue. We can highlight the queue manager <code>qmgr</code> and the queue name <code>queue</code>. Last, but not least, at the end of the line the measure captured for the metric with those attributes is provided. In this case <code>0</code> because the queue still does not hold any messages.</p> </li> <li> <p><em>Check the new metrics are shown in the metrics UI</em></p> <p>Now that the new metrics are being exposed, we are able to find them in Prometheus. Navigate to the <code>Monitoring &gt; Metrics</code> section in OpenShift web console.</p> <p>In the query textarea provide one of the new metrics like <code>ibmmq_queue_depth</code> and press enter.</p> <p><img alt="Queue depth metrics" src=../images/openshift-ibmmq-queue-depth-metric.png></p> <p>Results appear represented in a graph and listed under it. What we have done is to query using a metric name, but we have not provided any other detail. Then our query is retrieving the queue depth for all the queues in all the queue managers.</p> <p>Despite these metrics belongs to the user workload scope we are reaching it through the OpenShift metrics interface. Remember that in the previous topic we talked about this abstraction in the monitoring stack. We have two instances of Prometheus running, system workload and user defined workload, but we can reach all the metrics from the same UI no matter in which Prometheus instance these metrics are being stored.</p> </li> <li> <p><em>Narrow down the query</em></p> <p>If we want to have the results for a specific queue, we need to narrow down the query using the <code>queue</code> attribute. If we are looking for the queue depth of <code>IBM.DEMO.Q</code> queue, then issue the query</p> <div class=highlight><pre><span></span><code>ibmmq_queue_depth{queue=&quot;IBM.DEMO.Q&quot;}
</code></pre></div> <p>And you will have now only a single time series for this specific queue.</p> </li> </ol> <hr> <div class="admonition success"> <p class=admonition-title>Congratulations!</p> <p>You have successfully cloned and reviewed the metrics application source code. You have configured, and deployed it obtaining new metrics from our <code>QM1</code>. Finally you have been able to perform a query on Prometheus using the new exposed metric. In the next topic we are going to use one of these new metrics to customize the Grafana dashboard for MQ that we saw in the <a href=../topic1/ >Monitoring stack</a> section.</p> </div> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <!-- Footer --> <footer class=md-footer> <!-- Link to previous and/or next page --> <nav class="md-footer__inner md-grid" aria-label=Footer> <!-- Link to previous page --> <a href=../topic2/ class="md-footer__link md-footer__link--prev" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> MQ scenario </div> </div> </a> <!-- Link to next page --> <a href=../topic4/ class="md-footer__link md-footer__link--next" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Customising dashboard </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <!-- Further information --> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-column> <div class=md-footer-text>Site licensed under <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ >CC BY-NC-SA 4.0</a></div> </div> <div class=md-footer-column> <!-- Copyright and theme information --> <div class=md-footer-text> Copyright  2021 Cloud Pak Production Deployment Guides </div> </div> <div class=md-footer-social> <a href=https://github.ibm.com/cloudpakbringup/deployment-guides target=_blank rel=noopener title="Production Deployment Guides on Github Enterprise" class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"> <path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"> </path> </svg> </a> <a href=https://ibm-cloud.slack.com/archives/C02CQ6M2D2R target=_blank rel=noopener title=Slack class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"> <path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"> </path> </svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../../..", "features": ["navigation.tabs", "navigation.instant", "navigation.tracking", "navigation.tabs.sticky", "navigation.top", "navigation.sections"], "search": "../../../../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../../../assets/javascripts/bundle.6e54b5cd.min.js></script> </body> </html>